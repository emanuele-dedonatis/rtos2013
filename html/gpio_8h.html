<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>STM32F4 Pedometer: miosix/interfaces/gpio.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">STM32F4 Pedometer
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A pedometer library for the STM32F4 Discovery board by ST Microelectronics.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c4fe6004ef6ff3f06951047293fcfe0b.html">miosix</a></li><li class="navelem"><a class="el" href="dir_5a4e0eafef7f0d6775a36b65b84f6e04.html">interfaces</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gpio.h File Reference<div class="ingroups"><a class="el" href="group___interfaces.html">Interfaces</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;interfaces-impl/gpio_impl.h&quot;</code><br/>
</div>
<p><a href="gpio_8h_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The interface to gpios provided by Miosix is in the form of templates, therefore this file can only include gpio_impl.h with the architecture dependand code.</p>
<p>The interface should be as follows: First a class Mode containing an enum Mode_ needs to be defined. Its minimum implementation is this: </p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Mode</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">enum</span> Mode_</div>
<div class="line">    {</div>
<div class="line">        INPUT,</div>
<div class="line">        OUTPUT</div>
<div class="line">    };</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    Mode(); <span class="comment">//Just a wrapper class, disallow creating instances</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>This class should define the possible configurations of a gpio pin. The minimum required is INPUT and OUTPUT, but this can be extended to other options to reflect the hardware capabilities of gpios. For example, if gpios can be set as input with pull up, it is possible to add INPUT_PULL_UP to the enum.</p>
<p>Then a template Gpio class should be provided, with at least the following member functions: </p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> P, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> N&gt;</div>
<div class="line"><span class="keyword">class </span>Gpio</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> mode(Mode::Mode_ m);</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> high();</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">void</span> low();</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> value();</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    Gpio();<span class="comment">//Only static member functions, disallow creating instances</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>mode() should take a Mode::Mode_ enum and set the mode of the gpio (input, output or other architecture specific)</p>
<p>high() should set a gpio configured as output to high logic level</p>
<p>low() should set a gpio configured as output to low logic level</p>
<p>value() should return either 1 or 0 to refect the state of a gpio configured as input</p>
<p>Lastly, a number of constants must be provided to be passed as first template parameter of the Gpio class, usually identifying the gpio port, while the second template parameter should be used to specify a gpio pin within a port.</p>
<p>The intended use is this: considering an architecture with two ports, PORTA and PORTB each with 8 pins. The header gpio_impl.h should provide two constants, for example named GPIOA_BASE and GPIOB_BASE.</p>
<p>The user can declare the hardware mapping between gpios and what is connected to them, usually in an header file. If for example PORTA.0 is connected to a button while PORTB.4 to a led, the header file might contain:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> Gpio&lt;GPIOA_BASE,0&gt; button;</div>
<div class="line"><span class="keyword">typedef</span> Gpio&lt;GPIOB_BASE,4&gt; led;</div>
</div><!-- fragment --><p>This allows the rest of the code to be written in terms of leds and buttons, without a reference to which pin they are connected to, something that might change.</p>
<p>A simple code using these gpios could be: </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> blinkUntilButtonPressed()</div>
<div class="line">{</div>
<div class="line">    led::mode(Mode::OUTPUT);</div>
<div class="line">    button::mode(Mode::INPUT);</div>
<div class="line">    <span class="keywordflow">for</span>(;;)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>(button::value()==1) <span class="keywordflow">break</span>;</div>
<div class="line">        led::high();</div>
<div class="line">        <a class="code" href="group___hardware.html#ga030255d7e5175ed1ab2c4ce48276ef23">Thread::sleep</a>(250);</div>
<div class="line">        led::low();</div>
<div class="line">        <a class="code" href="group___hardware.html#ga030255d7e5175ed1ab2c4ce48276ef23">Thread::sleep</a>(250);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 31 2014 12:53:01 for STM32F4 Pedometer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
